---
interface FaqItem {
  question: string;
  answer: string;
}

const { faqs = [] as FaqItem[] } = Astro.props;

if (!faqs.length) {
  // Don’t emit any schema if there’s nothing to show
  return;
}

const toText = (s: string) =>
  s
    .replace(/<[^>]*>/g, '')
    .replace(/\s+/g, ' ')
    .trim();

const data = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: faqs.map((f) => ({
    '@type': 'Question',
    name: toText(f.question),
    acceptedAnswer: { '@type': 'Answer', text: toText(f.answer) },
  })),
};

const jsonLd = JSON.stringify(data, null, 2);
---

<Fragment set:html={`<script type="application/ld+json">${jsonLd}</script>`} />
