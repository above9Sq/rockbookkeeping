---
import H2 from '~/components/widgets/H2.astro';
import Container from '~/components/widgets/Container.astro';
import CtaBanner from '~/components/widgets/CtaBanner.astro';
import FeatureItem from '~/components/widgets/FeatureItem.astro';

interface Tier {
  name: string;
  introText: string;
  price: string;
  features: string[];
  outroText: string;
  popular?: boolean;
  badgeLabel: string;
  billingLabel: string;
}

interface Props {
  bgColor?: string;
}

const { bgColor = '#F7F9FF' } = Astro.props;

const monthlyTiers: Tier[] = [
  {
    name: 'Essential',
    introText:
      'Stress-free monthly bookkeeping that keeps your accounts accurate and your mind at ease.',
    price: '200',
    features: [
      'Reconcile all accounts',
      'Categorization of all transactions',
      'Monthly P&L and Balance Sheet statements',
    ],
    outroText: 'Best for business owners who just need clean, reliable books every month.',
    badgeLabel: 'Monthly',
    billingLabel: 'per month',
  },
  {
    name: 'Professional',
    introText:
      'Proactive bookkeeping for growing businesses that need clear cash flow and financial confidence.',
    price: '1000',
    features: ['All Essential', 'Full A/R & A/P', 'Cash flow tracking and insight'],
    outroText:
      'Best for growing businesses that want deeper visibility and full A/R & A/P management.',
    popular: false,
    badgeLabel: 'Monthly',
    billingLabel: 'per month',
  },
];

const cleanupTier: Tier = {
  name: 'Cleanup',
  introText: 'Perfect if your books are behind, messy, or you are switching to QuickBooks Online.',
  price: '1500',
  features: [
    'Fix messy or behind books',
    'QBO setup if needed',
    'Identify duplicate or missing transactions',
    'Correct past reconciliation errors',
    'Provide clean reports for tax or CPA use',
    'Jump to monthly for maintenance',
  ],
  outroText:
    'After cleanup, continue with monthly service or hand off a balanced file to your accountant.',
  badgeLabel: 'One-time project',
  billingLabel: 'one-time project',
};

const tierHeadingClasses =
  'text-lg sm:text-xl lg:text-2xl font-semibold text-gray-900 uppercase';
const priceClasses =
  'flex flex-col gap-1 mt-2 text-3xl leading-tight lg:text-4xl font-black text-gray-900';
const badgeClasses = `
  inline-flex self-start items-center rounded-full border border-blue-100 bg-blue-50
  px-2.5 py-0.5 text-[0.6rem] sm:px-3 sm:py-1 sm:text-[0.65rem]
  font-semibold uppercase tracking-[0.14em] text-blue-700 whitespace-nowrap
`;
---

<section
  id="pricing"
  class="py-16 sm:py-20 lg:py-24"
  style={`background-color: ${bgColor}`}
>
  <Container narrow maxWidth="max-w-[93rem]">
    <div class="flex flex-col gap-10 lg:gap-14 xl:gap-24">
      <!-- Header -->
      <div class="w-full max-w-2xl">
        <H2 align="left">Pricing</H2>
        <p class="mt-4 text-base sm:text-lg text-gray-700 text-left text-balance">
          Transparent, contract-free pricing with a first-month guarantee. Most owners save
          over $10k per year and 15 hours a month - buying back their time and peace of mind.
        </p>
      </div>

      <!-- Monthly tiers -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 xl:gap-16 w-full">
        {
          monthlyTiers.map((tier) => (
            <article
              class="relative flex flex-col bg-white rounded-xl p-8 lg:p-10
                     shadow-[0_2px_12px_rgba(0,0,0,0.06)]
                     transition-transform duration-150 hover:-translate-y-0.5"
            >
              {tier.popular && (
                <div class="absolute -top-3 right-6">
                  <span
                    class="inline-flex items-center rounded-full bg-[#23335A] text-white
                           text-[0.65rem] font-semibold tracking-[0.12em] uppercase
                           px-3 py-1 shadow-sm"
                  >
                    Most popular
                  </span>
                </div>
              )}

              <div
                class="flex flex-col sm:flex-row sm:items-start sm:justify-between
                       gap-2 sm:gap-4 mb-5"
              >
                <h3 class={tierHeadingClasses}>{tier.name}</h3>

                <span class={badgeClasses}>
                  {tier.badgeLabel}
                </span>
              </div>

              <p class="text-sm sm:text-base text-gray-700 mb-4 sm:mb-5">
                {tier.introText}
              </p>

              <div class="mb-5">
                <span class="block text-sm uppercase tracking-wide text-gray-500 font-semibold">
                  From
                </span>
                <span class="sr-only">Starting at</span>
                <p class={priceClasses}>${tier.price}</p>
                <span class="block text-base text-gray-600">
                  {tier.billingLabel}
                </span>
              </div>

              <ul
                class="space-y-3 flex-grow mb-4 sm:mb-6"
                aria-label={`Features included in the ${tier.name} plan`}
              >
                {tier.features.map((feature) => (
                  <FeatureItem feature={feature} />
                ))}
              </ul>

              <p class="text-sm sm:text-base text-gray-600">
                {tier.outroText}
              </p>
            </article>
          ))
        }
      </div>

      <!-- One-time cleanup -->
      <article
        class="bg-white rounded-xl p-8 lg:p-10
               shadow-[0_2px_12px_rgba(0,0,0,0.06)]
               flex flex-col items-start text-left"
      >
        <div class="w-full">
          <div
            class="flex flex-col sm:flex-row sm:items-center sm:justify-between
                   gap-2 sm:gap-4 mb-3"
          >
            <h3 class={tierHeadingClasses}>{cleanupTier.name}</h3>
            <span class={badgeClasses}>
              {cleanupTier.badgeLabel}
            </span>
          </div>

          <p class="text-sm sm:text-base text-gray-700 mb-4">
            {cleanupTier.introText}
          </p>

          <div class="mb-5">
            <span class="block text-sm uppercase tracking-wide text-gray-500 font-semibold">
              From
            </span>
            <span class="sr-only">Starting at</span>
            <p class={priceClasses}>${cleanupTier.price}</p>
            <span class="block text-base text-gray-600">
              {cleanupTier.billingLabel}
            </span>
          </div>
        </div>

        <ul
          class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-3 w-full max-w-[42rem] mt-2 mb-6 pt-1"
          aria-label={`Features included in the ${cleanupTier.name} plan`}
        >
          {cleanupTier.features.map((feature) => (
            <FeatureItem feature={feature} />
          ))}
        </ul>

        <p class="text-sm sm:text-base text-gray-600">
          {cleanupTier.outroText}
        </p>
      </article>

      <!-- CTA banner -->
      <CtaBanner
        header="Ready for your free audit?"
        subheader="No pressure, no commitment - just a clear view of what's working (and what's not) in your books."
        bgColor="#E3EDFF"
      />
    </div>
  </Container>
</section>
