---
import Logo from '/src/assets/images/rb-logo-horizontal-compact-light.svg';
import PhoneIcon from '/src/assets/images/phone-no-fill.svg';
import SmsIcon from '/src/assets/images/sms.svg';
import MobileMenu from './MobileMenu.astro';
import { headerData } from '~/navigation';

const { links, phoneNumber, useTextJoshInHeader } = headerData;

const numericPhone = phoneNumber.replace(/[^0-9]/g, '');
const phoneHref = `tel:${numericPhone}`;
const smsHref = `sms:${numericPhone}`;
---

<header class="sticky top-0 z-[80] w-full bg-white transition-[height] duration-300 ease-out">
  <nav
    class="relative w-full flex items-center pl-4 pr-8 sm:pl-6 xl:pl-[48px] xl:pr-[120px] mx-auto py-2 lg:py-3 lg:grid lg:grid-cols-12 lg:border-b lg:border-gray-200"
  >
    <!-- Logo (left) -->
    <div class="flex items-center lg:col-span-3">
      <a href="/" class="flex items-center" aria-label="Rock Bookkeeping">
        <Logo class="h-8 md:h-9 w-auto shrink-0" />
      </a>
    </div>

    <!-- Center nav (desktop) -->
    <div class="hidden lg:flex lg:col-span-6 items-center justify-center lg:gap-x-7">
      {
        links.map((item) => (
          <a
            class="text-gray-800 hover:text-gray-600 font-semibold text-sm uppercase tracking-wide transition-colors"
            href={item.href}
          >
            {item.text}
          </a>
        ))
      }
    </div>

    <!-- Right side: CTA (desktop) + mobile toggle -->
    <div class="flex items-center justify-end ml-auto lg:ml-0 lg:col-span-3 lg:justify-end gap-x-6">
      {
        useTextJoshInHeader ? (
          <a
            href={smsHref}
            class="hidden lg:inline-flex items-center gap-x-2 text-gray-800 hover:text-gray-600 font-semibold text-sm transition-colors"
            aria-label={`Text Rock Bookkeeping at ${phoneNumber}`}
          >
            <SmsIcon class="w-4 h-4 shrink-0" />
            <span>Text Josh: {phoneNumber}</span>
          </a>
        ) : (
          <a
            href={phoneHref}
            class="hidden lg:inline-flex items-center gap-x-2 text-gray-800 hover:text-gray-600 font-semibold text-sm transition-colors"
            aria-label={`Call Rock Bookkeeping at ${phoneNumber}`}
          >
            <PhoneIcon class="w-4 h-4 shrink-0" />
            <span>{phoneNumber}</span>
          </a>
        )
      }

      <!-- Mobile toggle -->
      <div class="lg:hidden">
        <button
          id="rb-toggle"
          aria-expanded="false"
          aria-controls="rb-menu"
          aria-label="Toggle navigation"
          class="size-12 ml-2 flex justify-center items-center rounded-xl text-gray-900 hover:bg-gray-100 transition-colors"
        >
          <!-- hamburger / close icons unchanged -->
          <svg
            class="icon-menu block size-7 stroke-[1.5]"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
          >
            <line x1="3" x2="21" y1="6" y2="6" stroke="currentColor" stroke-linecap="round"></line>
            <line x1="3" x2="21" y1="12" y2="12" stroke="currentColor" stroke-linecap="round"></line>
            <line x1="3" x2="21" y1="18" y2="18" stroke="currentColor" stroke-linecap="round"></line>
          </svg>
          <svg
            class="icon-close hidden size-7 stroke-[1.5]"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
          >
            <path d="M18 6 6 18" stroke="currentColor" stroke-linecap="round"></path>
            <path d="m6 6 12 12" stroke="currentColor" stroke-linecap="round"></path>
          </svg>
        </button>
      </div>
    </div>
  </nav>

  <MobileMenu navItems={links} />
</header>
