---
import Container from '~/components/widgets/Container.astro';
import H2 from '~/components/widgets/H2.astro';
import CalButton from '~/components/widgets/CalButton.astro';
import CtaButton from '~/components/widgets/CtaButton.astro';
import { headerData } from '~/navigation';

export interface Props {
  id?: string;
  header: string;
  paragraphs: string[];
  bgColor?: string; // tailwind class
}

const { id = 'final-cta', header, paragraphs = [], bgColor = 'bg-[#002057]' } = Astro.props;

const safeParagraphs = Array.isArray(paragraphs) ? paragraphs : [];

const { phoneNumber } = headerData;
const strippedPhone = phoneNumber.replace(/[^0-9]/g, '');
const smsHref = `sms:${strippedPhone}`;
const phoneHref = `tel:${strippedPhone}`;
---

<section id={id} class={`pt-14 sm:pt-16 lg:pt-20 pb-14 sm:pb-16 lg:pb-20 ${bgColor}`}>
  <Container narrow maxWidth="max-w-[93rem]">
    <div class="max-w-3xl">


      <div class="mt-3">
        <H2 align="left" color="light">{header}</H2>
      </div>

      {
        safeParagraphs.length > 0 && (
          <div class="mt-4 sm:mt-6 space-y-4 text-base sm:text-lg leading-relaxed text-white/85">
            {safeParagraphs.map((t) => (
              <p>{t}</p>
            ))}
          </div>
        )
      }

      <div class="mt-8 flex flex-col sm:flex-row gap-3 sm:gap-4">
        <CalButton narrow label="Book a call with Josh" hero />
        <CtaButton narrow variant="outlineLight" label="Send Josh a quick note" hero />
      </div>

      <div class="mt-5 text-sm sm:text-base text-white/75">
        <span class="italic">Prefer calling?&nbsp;</span>{' '}
        <a href={phoneHref} class="underline underline-offset-4 hover:text-white">
          {phoneNumber}
        </a>
      </div>
    </div>
  </Container>
</section>
