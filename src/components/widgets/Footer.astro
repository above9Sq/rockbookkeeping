---
import { SITE } from 'astrowind:config';
import { getHomePermalink } from '~/utils/permalinks';

interface Link {
  text?: string;
  href?: string;
  ariaLabel?: string;
  icon?: string;
}

interface LinksGroup {
  title?: string;
  links: Array<Link>;
}

export interface Props {
  links: Array<LinksGroup>;
  secondaryLinks: Array<Link>;
  socialLinks: Array<Link>;
  footNote?: string;
  theme?: string;
}

const { secondaryLinks = [], links = [], footNote = '' } = Astro.props;

// flatten all groups into a single list
const flatLinks: Array<Link> = (links || []).flatMap((g) => g?.links || []).filter(Boolean);

// If you prefer a default copyright, uncomment below:
// const year = new Date().getFullYear();
// const defaultFoot = `© ${year} Rock Bookkeeping. Made with <span class="text-red-400">❤️</span> in Pittsburgh.`;
---

<footer class="relative border-t border-gray-700 bg-[#0d1b2a] not-prose">
  <div class="relative max-w-7xl mx-auto px-4 sm:px-6 py-10 md:py-12 flex flex-col items-center text-center gap-6">
    <!-- Brand -->
    <div>
      <a class="inline-block font-bold text-xl text-white tracking-tight" href={getHomePermalink()}>
        {SITE?.name}
      </a>
    </div>

    <!-- Main Links -->
    {
      flatLinks.length > 0 && (
        <ul class="flex flex-wrap justify-center gap-x-6 gap-y-2 text-base text-gray-300">
          {flatLinks.map(({ text, href, ariaLabel }) => (
            <li>
              <a class="hover:text-white transition-colors duration-150" href={href} aria-label={ariaLabel}>
                <Fragment set:html={text} />
              </a>
            </li>
          ))}
        </ul>
      )
    }

    <!-- Legal Links -->
    {
      secondaryLinks?.length > 0 && (
        <div class="text-sm text-gray-400 flex flex-wrap justify-center gap-x-4 gap-y-1 mt-1" aria-label="Legal">
          {secondaryLinks.map(({ text, href }) => (
            <a class="hover:text-gray-200 transition-colors duration-150" href={href} set:html={text} />
          ))}
        </div>
      )
    }

    <!-- Copyright / Made with ❤️ -->
    <div class="text-xs font-semibold text-gray-400 mt-1 leading-relaxed uppercase">
      <Fragment set:html={footNote} />
    </div>
  </div>
</footer>
